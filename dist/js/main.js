"use strict";function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var _createClass=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}(),delay=function(){var e=0;return function(t,n){var a=!(arguments.length<=2||void 0===arguments[2])&&arguments[2];a&&clearTimeout(e),e=setTimeout(t,n)}}();$(function(){"undefined"!=typeof FastClick&&FastClick.attach(document.body);var e=new Date;e.setYear(e.getFullYear()-80);var t=new Date;t.setYear(t.getFullYear()-15),$(".datepicker").pickadate({selectMonths:!0,selectYears:65,min:e,max:t,format:"yyyy-mm-dd",today:""}),$("a.btn-floating").on("click",function(e){e.preventDefault();var t=$(e.target);$("html, body").animate({scrollTop:$(t.attr("href")).offset().top},700)}),getRegistrationForm()});var initAutocomplete=function(){var e=document.getElementById("register_coffeeshop"),t=new google.maps.places.SearchBox(e);t.addListener("places_changed",function(){var e=t.getPlaces();0!=e.length&&e.forEach(function(e){if(!e.geometry)return void console.log("Returned place contains no geometry");({url:e.icon,size:new google.maps.Size(71,71),origin:new google.maps.Point(0,0),anchor:new google.maps.Point(17,34),scaledSize:new google.maps.Size(25,25)});console.log(e),$("#register_coffeeshop_maps").val(JSON.stringify({name:e.name,lat:e.geometry.location.lat(),lng:e.geometry.location.lng(),vicinity:e.vicinity}))})})};!function(e){var t=function(){function e(t){_classCallCheck(this,e);for(var n in t)this[n]=t[n];var a=this.element;this.dimention={image:e.getDimension(a),parent:e.getDimension(a.closest("div"))}}return _createClass(e,[{key:"getOrientation",value:function(){var t=e.getRatio(this.dimention.image),n=e.getRatio(this.dimention.parent),a="portrait";return t>1&&t>n&&!this.revert&&(a="landscape"),a}}],[{key:"getDimension",value:function(e){return{width:e.width(),height:e.height()}}},{key:"getRatio",value:function(e){return e.width/e.height}}]),e}();e.widget("pls.pictureOrientation",{options:{revert:!1},_create:function(){var e=this;this._destroy();var t=this.element;this.complete||t.height()>0?this._calcClass(t):t.on("load",function(){e._calcClass(t)})},reflow:function(){this._create()},_calcClass:function(e){var n={element:this.element,revert:this.options.revert},a=new t(n).getOrientation();e.addClass("img--"+a)},_destroy:function(){this.element.removeClass("img--portrait img--landscape")}})}(jQuery);var Form=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"removeFlash",value:function(){$(".parsley-errors-list.filled, .parsley-success-list.filled").remove()}}]),e}(),Progress=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"getElement",value:function(){return $(".progress")}},{key:"show",value:function(){e.getElement().show()}},{key:"hide",value:function(){e.getElement().hide()}}]),e}(),getRegistrationForm=function(){var e=!1,t=$("#registration"),n=void 0,a=function(){return t.find("#form_registration")},r=function(){Progress.hide();var r=a();if(e||(t.find(".card-content").empty().append(n),r=a()),r.length>0){r.on("change","#register_picture",function(e){var t=$(e.target),n=t.closest(".col").find("img"),a=t[0];if(a.files&&a.files[0]){var r=new FileReader;r.onload=function(e){n.attr("src",e.target.result),t.closest(".btn").find("span").text("taken")},r.readAsDataURL(a.files[0])}});var i=function(e){e.preventDefault();var n=$(e.target),a=new FormData(n[0]),r=t.find('button[type="submit"]'),i=void 0,o=void 0;return $.ajax({url:""+urlBase+n.attr("action"),dataType:"json",type:n.attr("method"),data:a,beforeSend:function(){Form.removeFlash(),Progress.show(),r.attr("disabled",!0)},success:function(e){i=e.message,o=e},error:function(e){i=Template.flash(!1,e.statusText)},complete:function(){r.attr("disabled",!1),null!=o&&""!=o.element?t.find("[name="+o.element+"]").trigger("focus").closest(".col").find("label").attr("data-error",i).end().end().closest(".col").find(".validate").addClass("invalid"):(i=Template.flash(o.status,i),r.before(i)),Progress.hide()},cache:!1,contentType:!1,processData:!1}),!1};r.off("submit").on("submit",i);var o="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjhGHb81MIdRsBEJhhSSUe78JLGIRhHJA&libraries=places&callback=initAutocomplete";0===$("body").find('script[src="'+o+'"]').length&&$("body").append('<script src="'+o+'"></script>');var s=function(){$("#register_coffeeshop").removeAttr("placeholder")};delay(s,1700)}};$.ajax({url:urlBase+"/helper/time",dataType:"json",beforeSend:function(){Progress.show()},success:function(t){e=t.registrationOpen,e||(n=t.registration.start.split(" ")[0]+" - "+t.registration.end.split(" ")[0],n=TemplateForm.notOpen(n))},error:function(e){n=Template.flash(!1,e.statusText)},complete:r})},Template=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"flash",value:function(e,t){var n=e?"parsley-success-list":"parsley-errors-list";return'<ul class="'+n+' filled">\n    <li>'+t+"</li>\n</ul>"}}]),e}(),TemplateForm=function(){function e(){_classCallCheck(this,e)}return _createClass(e,null,[{key:"notOpen",value:function(){var e=arguments.length<=0||void 0===arguments[0]?"":arguments[0];return'<p align="center">Open on <br/>'+e+"</p>"}}]),e}(),isProd=!0,urlBase="192.168.2.50:8080";isProd&&(urlBase="api.baristawars2016.com/public"),urlBase="http://"+urlBase;
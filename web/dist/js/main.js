"use strict";var isProd="192.168.2.50"!==window.location.hostname&&"localhost"!==window.location.hostname,urlBase="192.168.2.50:8080";isProd&&(urlBase="api.baristawars2016.com/public"),urlBase="http://"+urlBase;var fullpageRebuild=function(){null!=$.fn.fullpage.reBuild&&$.fn.fullpage.reBuild()},getRegistrationForm=function(){var e=!1,t=$("#section2"),a=void 0;$.ajax({url:urlBase+"/helper/time",dataType:"json",beforeSend:function(){t.find(".parsley-errors-list.filled, .parsley-success-list.filled").remove().end()},success:function(t){e=t.registrationOpen,e||(a=t.registration.start.split(" ")[0]+" - "+t.registration.end.split(" ")[0],a=TemplateForm.notOpen(a))},error:function(e){a=Template.flash(!1,e.statusText)},complete:function(){t.find(".mdl-progress").hide();var i=t.find("form");if(e||(t.find(".mdl-card__supporting-text").empty().append(a),i=t.find("#form_registration")),0===i.length)t.find(".mdl-card__actions.mdl-card--border").remove();else{i.find("#register_dob").datepicker({changeMonth:!0,changeYear:!0,minDate:"-80y",maxDate:"-5y",yearRange:"-100:-5",dateFormat:"yy-mm-dd",onSelect:function(e,t){var a=t.input;a.closest(".mdl-textfield").removeClass("is-invalid").addClass("is-dirty")}}),i.on("click tap touchstart","label[for=register_picture]",function(e){$(e.target);$("#register_picture").trigger("click tap touchstart")}).on("change","#register_picture",function(e){var t=$(e.target),a=t.closest(".mdl-card").find(".mdl-card__title"),i=t[0];if(console.log(a),i.files&&i.files[0]){var r=new FileReader;r.onload=function(e){a.css("background-image","url("+e.target.result+")"),t.closest("label").find(".mdl-button").text("picture taken").addClass("mdl-button--raised"),fullpageRebuild()},r.readAsDataURL(i.files[0])}}),t.off("click",".mdl-card__actions button").on("click",".mdl-card__actions button",function(e){i.trigger("submit")}),i.off("submit").on("submit",function(e){e.preventDefault();var a=$(e.target),i=new FormData(a[0]),r=t.find('button[type="submit"]'),s=void 0,l=void 0;return $.ajax({url:""+urlBase+a.attr("action"),dataType:"json",type:a.attr("method"),data:i,beforeSend:function(){r.attr("disabled",!0),t.find(".parsley-errors-list.filled, .parsley-success-list.filled").remove().end().find(".mdl-progress").show()},success:function(e){s=Template.flash(e.status,e.message),l=e},error:function(e){s=Template.flash(!1,e.statusText)},complete:function(){r.attr("disabled",!1),null!=l&&""!=l.element?t.find("[name="+l.element+"]").closest(".mdl-textfield").addClass("is-invalid").end().closest(".mdl-grid").append(s).end():r.before(s),t.find(".mdl-progress").hide(),fullpageRebuild()},cache:!1,contentType:!1,processData:!1}),!1});var r="https://maps.googleapis.com/maps/api/js?key=AIzaSyBjhGHb81MIdRsBEJhhSSUe78JLGIRhHJA&libraries=places&callback=initAutocomplete";0===$("body").find('script[src="'+r+'"]').length&&$("body").append('<script src="'+r+'"></script>');var s=function(){$("#register_coffeeshop").removeAttr("placeholder")};delay(s,700),fullpageRebuild()}}})};$(function(){"undefined"!=typeof FastClick&&FastClick.attach(document.body);var e=function(e,t){switch(e){case"registration":getRegistrationForm()}};$("#fullpage").fullpage({anchors:["main","registration"],responsiveWidth:500,fitToSection:!1,scrollOverflowOptions:{tap:!0},afterLoad:e})});